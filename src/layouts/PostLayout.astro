---
import Layout from './Layout.astro';

const { frontmatter } = Astro.props as any;
const {
  title = 'Entrada de blog',
  description = '',
  pubDate,
} = frontmatter ?? {};

const formattedDate = pubDate ? new Date(pubDate).toLocaleDateString('es-CL', { year: 'numeric', month: 'long', day: 'numeric' }) : undefined;
// heroImage puede venir desde el frontmatter o como export nombrado en MDX
const _rawHero = (Astro.props as any).heroImage ?? (frontmatter?.heroImage ?? undefined);
const heroSrc = typeof _rawHero === 'string' ? _rawHero : (_rawHero?.src ?? undefined);
---

<Layout title={`${title} | Blog`} description={description}>
  <main class="bg-gray-900 text-white pt-24">
    {heroSrc && (
      <div class="container mx-auto px-4 max-w-4xl mb-6">
        <div class="rounded-xl border border-gray-800 overflow-hidden">
          <img
            src={heroSrc}
            alt={title}
            class="w-full h-56 md:h-72 lg:h-80 object-cover"
            loading="eager"
            decoding="async"
          />
        </div>
      </div>
    )}
    <header class="container mx-auto px-4 max-w-4xl mb-8">
      <h1 class="text-3xl md:text-4xl font-extrabold mb-3">{title}</h1>
      {formattedDate && <p class="text-gray-400">{formattedDate}</p>}
      {description && <p class="mt-3 text-gray-300">{description}</p>}
    </header>

    <article class="container mx-auto px-4 max-w-4xl prose prose-invert prose-lg">
      <slot />
    </article>
  </main>
</Layout>

<style>
  .prose :where(img):not(:where([class~="not-prose"] *)) {
    border-radius: 0.75rem;
    border: 1px solid rgb(31 41 55/1);
  }
</style>
